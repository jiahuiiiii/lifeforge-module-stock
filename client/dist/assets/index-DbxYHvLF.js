import{importShared as o}from"./__federation_fn_import-E6wRZccp.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{f as h}from"./forgeAPI-DuNy0l6-.js";import{I as m}from"./iconify-CHsp7AQ2.js";const{Button:f,Card:g,LoadingScreen:b}=await o("lifeforge-ui"),{Link:p}=await o("shared");function u({item:r,quote:s,removeFromWatchlist:l}){const a=s==="error"?!1:s?.change>=0,c=s===void 0;return e.jsxs(g,{className:`relative flex flex-col overflow-hidden transition-all duration-200 hover:shadow-lg ${c?"":a?"border-l-4 border-l-green-500":"border-l-4 border-l-red-500"}`,children:[e.jsxs("div",{className:"mb-4 flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(p,{className:"hover:text-custom-500 text-xl font-bold tracking-tight transition-colors",to:"/",children:r.symbol}),e.jsx("p",{className:"text-bg-500 mt-0.5 truncate text-sm",children:r.name})]}),e.jsx(f,{className:"text-bg-400 -mt-1 -mr-2 shrink-0 p-2! hover:text-red-500",icon:"tabler:x",type:"button",variant:"plain",onClick:()=>l(r.symbol)})]}),s==="error"?e.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-red-500/10 px-3 py-2 text-sm text-red-500",children:[e.jsx(m,{className:"size-4",icon:"tabler:alert-circle"}),"Unable to fetch data"]}):s?e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"text-3xl font-bold tracking-tight",children:["$",s.price.toFixed(2)]})}),e.jsxs("div",{className:`flex items-center gap-1 rounded-full px-3 py-1.5 text-sm font-semibold ${a?"bg-green-500/15 text-green-600 dark:text-green-400":"bg-red-500/15 text-red-600 dark:text-red-400"}`,children:[e.jsx(m,{className:"size-4",icon:a?"tabler:trending-up":"tabler:trending-down"}),e.jsxs("span",{children:[a?"+":"",s.changePercent.toFixed(2),"%"]})]})]}):e.jsx("div",{className:"flex-center py-4",children:e.jsx(b,{loaderSize:"1.5rem"})}),s&&s!=="error"&&e.jsxs("div",{className:`mt-3 border-t pt-3 text-sm ${a?"border-green-500/20 text-green-600 dark:text-green-400":"border-red-500/20 text-red-600 dark:text-red-400"}`,children:[a?"+":"","$",s.change.toFixed(2)," today"]})]},r.symbol)}const{useQueries:j}=await o("@tanstack/react-query"),{EmptyStateScreen:y,ModuleHeader:x}=await o("lifeforge-ui"),{useEffect:v,useMemo:N,useState:w}=await o("react");function _(){const[r,s]=w([]);v(()=>{const t=localStorage.getItem("stock_watchlist");if(t)try{s(JSON.parse(t))}catch(i){console.error("Failed to parse watchlist",i)}},[]);const l=j({queries:r.map(t=>h.getQuote.input({symbol:t.symbol}).queryOptions({refetchInterval:3e4,enabled:!!t.symbol,retry:0}))}),a=N(()=>{const t={};return r.forEach((i,d)=>{const n=l[d];n.isError&&(console.error("Failed to fetch quote",n.error),t[i.symbol]="error"),n.data&&(t[i.symbol]=n.data)}),t},[l,r]),c=t=>{const i=r.filter(d=>d.symbol!==t);s(i),localStorage.setItem("stock_watchlist",JSON.stringify(i))};return r.length===0?e.jsxs("div",{className:"animate-[fadeSlideIn_0.3s_ease-out]",children:[e.jsx(x,{}),e.jsx(y,{icon:"tabler:eye-off",message:{id:"watchlist",namespace:"apps.jiahuiiiii$stock"}})]}):e.jsxs("div",{className:"animate-[fadeSlideIn_0.3s_ease-out]",children:[e.jsx(x,{title:"Watchlist"}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-bg-500",children:"Track your favorite stocks in real-time. Prices update every 30 seconds."})}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:r.map(t=>e.jsx(u,{item:t,quote:a[t.symbol],removeFromWatchlist:c},t.symbol))})]})}export{_ as default};
