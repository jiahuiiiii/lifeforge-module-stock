import{importShared as j}from"./__federation_fn_import-E6wRZccp.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{I as m}from"./iconify-CHsp7AQ2.js";import{u as i}from"./store-Cu4D6-5t.js";const{Button:x,Card:b,ConfirmationModal:f,ModuleHeader:y,useModalStore:v}=await j("lifeforge-ui"),{useState:w}=await j("react"),{useNavigate:k}=await j("shared"),C={cagr:"tabler:trending-up",dy:"tabler:percentage",pe:"tabler:chart-bar",margin:"tabler:chart-pie",roe:"tabler:activity"};function I({config:t,metricId:g,onUpdate:c}){const o=(a,r,l)=>{const d=parseFloat(l)||0,n=[...t.tiers];n[a]={...n[a],[r]:d},c({...t,tiers:n})},u=()=>{const a=t.tiers[t.tiers.length-1],r={threshold:a?a.threshold-5:0,score:a?Math.max(0,a.score-10):0};c({...t,tiers:[...t.tiers,r]})},h=a=>{if(t.tiers.length<=1)return;const r=t.tiers.filter((l,d)=>d!==a);c({...t,tiers:r})};return e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-custom-500/10 flex size-10 items-center justify-center rounded-lg",children:e.jsx(m,{className:"text-custom-500 size-5",icon:C[g]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:t.label}),e.jsx("span",{className:"text-bg-500 text-xs",children:t.isInverse?"Lower is better":"Higher is better"})]}),e.jsx(x,{className:"",icon:"tabler:plus",variant:"secondary",onClick:u,children:"Add Tier"})]}),e.jsxs("div",{className:"bg-bg-100 dark:bg-bg-800/50 overflow-hidden rounded-lg",children:[e.jsxs("div",{className:"border-bg-200 dark:border-bg-700 grid grid-cols-[1fr_auto_auto] gap-2 border-b px-3 py-2 text-xs font-medium",children:[e.jsx("span",{className:"text-bg-500",children:"Condition"}),e.jsx("span",{className:"text-bg-500 w-16 text-center",children:"Score"}),e.jsx("span",{className:"w-8"})]}),t.tiers.map((a,r)=>e.jsxs("div",{className:"border-bg-200/50 dark:border-bg-700/50 grid grid-cols-[1fr_auto_auto] items-center gap-2 border-b px-3 py-2 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-bg-500",children:"Value"}),e.jsx("span",{className:"text-custom-500 font-medium",children:t.isInverse?"≤":"≥"}),e.jsx("input",{className:"border-bg-200 bg-bg-50 dark:border-bg-700 dark:bg-bg-900 w-16 rounded border px-2 py-1 text-center text-sm",type:"number",value:a.threshold===1/0?"":a.threshold,onChange:l=>o(r,"threshold",l.target.value)}),e.jsx("span",{className:"text-bg-500",children:t.unit})]}),e.jsx("input",{className:"border-bg-200 bg-bg-50 dark:border-bg-700 dark:bg-bg-900 w-16 rounded border px-2 py-1 text-center text-sm font-semibold",type:"number",value:a.score,onChange:l=>o(r,"score",l.target.value)}),e.jsx("button",{className:"text-bg-400 flex size-8 items-center justify-center rounded transition-colors hover:text-red-500 disabled:opacity-30",disabled:t.tiers.length<=1,title:"Delete tier",type:"button",onClick:()=>h(r),children:e.jsx(m,{className:"size-4",icon:"tabler:x"})})]},r))]})]})}function T(){const t=i(s=>s.settings),g=i(s=>s.updateMetricConfig),c=i(s=>s.resetToDefaults),o=i(s=>s.logs),u=i(s=>s.clearLogs),h=i(s=>s.cashFlowScores),a=i(s=>s.updateCashFlowScore),{open:r}=v(),l=k(),d=["cagr","dy","pe","margin","roe"],[n,N]=w(!0);return e.jsxs("div",{className:"animate-[fadeSlideIn_0.3s_ease-out]",children:[e.jsx(y,{title:"Analyzer Settings"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[d.map(s=>e.jsx(I,{config:t[s],metricId:s,onUpdate:p=>g(s,p)},s)),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-custom-500/10 flex size-10 items-center justify-center rounded-lg",children:e.jsx(m,{className:"text-custom-500 size-5",icon:"tabler:coin"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:"Cash Flow"}),e.jsx("span",{className:"text-bg-500 text-xs",children:"Profit/Loss + Inflow/Outflow"})]}),e.jsx(x,{icon:n?"tabler:lock":"tabler:lock-open",variant:"secondary",onClick:()=>N(!n),children:n?"Unlock":"Lock"})]}),e.jsxs("div",{className:"bg-bg-100 dark:bg-bg-800/50 divide-bg-200 dark:divide-bg-700/50 divide-y rounded-lg",children:[e.jsxs("div",{className:"border-bg-200 dark:border-bg-700 grid grid-cols-[1fr_auto_auto] gap-2 border-b px-3 py-2 text-xs font-medium",children:[e.jsx("span",{className:"text-bg-500",children:"Condition"}),e.jsx("span",{className:"text-bg-500 w-16 text-center",children:"Score"}),e.jsx("span",{className:"w-8"})]}),[{key:"profit_inflow",label:"Profit + Net Inflow"},{key:"profit_outflow",label:"Profit + Net Outflow"},{key:"loss_inflow",label:"Loss + Net Inflow"},{key:"loss_outflow",label:"Loss + Net Outflow"}].map(s=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("span",{className:"text-sm",children:s.label}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"border-bg-200 bg-bg-50 dark:border-bg-700 dark:bg-bg-900 w-16 rounded border px-2 py-1 text-center text-sm font-semibold disabled:cursor-not-allowed disabled:opacity-50",disabled:n,min:"0",type:"number",value:h[s.key],onChange:p=>a(s.key,parseInt(p.target.value)||0)}),e.jsx("span",{className:"text-bg-500 text-xs",children:"pts"})]})]},s.key))]})]})]}),e.jsxs(b,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-custom-500/10 flex size-10 items-center justify-center rounded-lg",children:e.jsx(m,{className:"text-custom-500 size-5",icon:"tabler:checklist"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Scoring Configuration"}),e.jsx("span",{className:"text-bg-500 text-xs",children:"Customize thresholds for each metric. Changes apply immediately."})]})]}),e.jsx(x,{dangerous:!0,icon:"tabler:refresh",variant:"secondary",onClick:()=>r(f,{title:"Reset to Defaults",description:"Are you sure you want to reset all scoring settings to their default values? This action cannot be undone.",confirmationButton:"confirm",onConfirm:async()=>{c()}}),children:"Reset Defaults"})]}),e.jsxs(b,{className:"mb-5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex size-10 items-center justify-center rounded-lg bg-purple-500/10",children:e.jsx(m,{className:"size-5 text-purple-500",icon:"tabler:notebook"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Analysis Logbook"}),e.jsxs("span",{className:"text-bg-500 text-xs",children:[o.length," saved"," ",o.length===1?"analysis":"analyses"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[o.length>0&&e.jsx(x,{dangerous:!0,icon:"tabler:trash",variant:"secondary",onClick:()=>r(f,{title:"Clear All Logs",description:"Are you sure you want to delete all saved analyses? This action cannot be undone.",confirmationButton:"delete",onConfirm:async()=>{u()}}),children:"Clear All Logs"}),e.jsx(x,{icon:"tabler:external-link",variant:"secondary",onClick:()=>l("../analyzer/logbook"),children:"View Logbook"})]})]})]})]})}export{T as default};
